// тЬЕ 100 Bangla sentences
const sentences = [
  "рждрзБржорж┐ ржПржЦржи ржХрзЛржерж╛ржпрж╝ ржпрж╛ржЪрзНржЫрзЛ?", "ржЖржорж┐ ржЖржЬржХрзЗ ржмрж╛ржбрж╝рж┐ ржпрж╛ржЪрзНржЫрж┐ред", "ржПржЦржи ржХржпрж╝ржЯрж╛ ржмрж╛ржЬрзЗ ржмрж▓рзЛ?", "ржжрзБржкрзБрж░ ржЗрждрж┐ржоржзрзНржпрзЗржЗ рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗред",
  "ржжрж░ржЬрж╛ рждрж╛ржбрж╝рж╛рждрж╛ржбрж╝рж┐ ржЦрзБрж▓рзЛред", "ржЖрж▓рзЛржЯрж╛ ржирж┐ржнрж┐ржпрж╝рзЗ ржжрж╛ржУред", "ржЖржорж┐ ржХрж┐ржЫрзБ ржЦрзЗрждрзЗ ржЪрж╛ржЗред", "ржнрж╛ржд ржПржХрзЗржмрж╛рж░рзЗ рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗред",
  "ржЖржорж╛ржХрзЗ ржПржХржЯрзБ ржкрж╛ржирж┐ ржжрж╛ржУред", "ржЖржорж┐ ржЖржЬ ржЦрзБржм ржХрзНрж▓рж╛ржирзНрждред", "ржЪрж▓ ржЖржорж░рж╛ ржмрж╛ржЗрж░рзЗ ржпрж╛ржЗред", "ржЖржорж┐ ржПржЦржиржЗ ржЖрж╕ржЫрж┐ред",
  "рждрзБржорж┐ ржХрж┐ ржХрж╛рж▓ ржЖрж╕ржмрзЗ?", "ржЖржЬржХрзЗ ржЦрзБржм ржЧрж░ржо рж▓рж╛ржЧржЫрзЗред", "ржмрж╛ржЗрж░рзЗ ржмрзГрж╖рзНржЯрж┐ ржкржбрж╝ржЫрзЗред", "ржЫрж╛рждрж╛ ржирж┐ржпрж╝рзЗ ржпрж╛ржУ ржПржЦржиред",
  "рждрзБржорж┐ ржЖржЬ ржХрзЗржоржи ржЖржЫрзЛ?", "ржЖржорж┐ ржЦрзБржм ржнрж╛рж▓рзЛ ржЖржЫрж┐ред", "ржПржЦрж╛ржирзЗ ржПрж╕рзЗ ржмрж╕рзЛред", "ржУржЗ ржмржЗржЯрж╛ ржЖржорж╛ржХрзЗ ржжрж╛ржУред",
  "рждрзЛржорж╛рж░ ржирж╛ржоржЯрж╛ ржХрзА ржмрж▓рзЛ?", "ржЖржорж╛рж░ ржирж╛ржо рж░ржлрж┐ржХ рж╣рж╛рж╕рж╛ржиред", "рждрзБржорж┐ ржХрзЛржерж╛ ржерзЗржХрзЗ ржЖрж╕ржЫрзЛ?", "ржЖржорж┐ ржЪржЯрзНржЯржЧрзНрж░рж╛ржо рж╢рж╣рж░ ржерзЗржХрзЗред",
  "рждрзБржорж┐ ржХрж┐ ржкржбрж╝рж╛рж╢рзЛржирж╛ ржХрж░ржЫрзЛ?", "ржЖржорж┐ ржПржЦржи ржмрж╛ржВрж▓рж╛ ржкржбрж╝ржЫрж┐ред", "ржжрж░ржЬрж╛ржпрж╝ ржХрзЗ ржжрж╛ржБржбрж╝рж┐ржпрж╝рзЗржЫрзЗ?", "ржЖржорж┐ ржПржЦрж╛ржирзЗржЗ ржЫрж┐рж▓рж╛ржоред",
  "рждрзБржорж┐ ржХрж┐ ржПржЦржи ржмрзНржпрж╕рзНржд?", "рж╣рзНржпрж╛ржБ, ржЖржорж┐ ржПржХржЯрзБ ржмрзНржпрж╕рзНрждред", "рждрзБржорж┐ ржХрж┐ ржХрж┐ржЫрзБ ржЦрж╛ржмрзЗ?", "ржЖржорж┐ ржПржХ ржХрж╛ржк ржЪрж╛ ржЦрж╛ржмрзЛред",
  "ржнрж╛ржд ржЦрж╛ржУржпрж╝рж╛ рж╢рзЗрж╖ рж╣ржпрж╝рзЗржЫрзЗ?", "рж╣рзНржпрж╛ржБ, ржПржЦржиржЗ рж╢рзЗрж╖ рж╣ржпрж╝рзЗржЫрзЗред", "рждрзБржорж┐ ржХрж┐ ржЧрж╛ржи рж╢рзБржиржЫрзЛ?", "рж╣рзНржпрж╛ржБ, ржЖржорж┐ ржЧрж╛ржи рж╢рзБржиржЫрж┐ред",
  "ржЖржорж┐ ржорж╛ржЭрзЗ ржорж╛ржЭрзЗ ржЧрж╛ржи ржЧрж╛ржЗред", "ржЯрж┐ржнрж┐ ржПржЦржиржЗ ржЪрж╛рж▓рж╛ржУред", "ржЯрж┐ржнрж┐ рждрж╛ржбрж╝рж╛рждрж╛ржбрж╝рж┐ ржмржирзНржз ржХрж░рзЛред", "ржЖржорж┐ ржмржЗ ржкржбрж╝рждрзЗ ржЪрж╛ржЗред",
  "рждрзЛржорж╛рж░ ржХрж▓ржоржЯрж╛ ржХрзЛржерж╛ржпрж╝?", "ржХрж▓ржоржЯрж╛ ржПржЦрж╛ржирзЗржЗ ржЖржЫрзЗред", "ржЖржорж╛ржХрзЗ ржорзЛржмрж╛ржЗрж▓ржЯрж╛ ржжрж╛ржУ рждрзЛред", "ржлрзЛржирзЗрж░ ржЪрж╛рж░рзНржЬ рж╢рзЗрж╖ рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗред",
  "рждрзЛржорж╛рж░ ржмрж╛рж╕рж╛ ржХрзЛржерж╛ржпрж╝ ржмрж▓рзЛ?", "ржЖржорж╛рж░ ржмрж╛рж╕рж╛ ржврж╛ржХрж╛рж░ ржнрж┐рждрж░рзЗред", "ржЖржЬ рж╢рзБржХрзНрж░ржмрж╛рж░ рж╕ржХрж╛рж▓ред", "ржЖржЧрж╛ржорзАржХрж╛рж▓ ржЫрзБржЯрж┐рж░ ржжрж┐ржиред",
  "рждрзБржорж┐ ржХрж┐ рж╕рждрзНржпрж┐ржЗ ржЖрж╕ржмрзЗ?", "рж╣рзНржпрж╛ржБ, ржЖржорж┐ ржЕржмрж╢рзНржпржЗ ржЖрж╕ржмрзЛред", "рждрзБржорж┐ ржЖржЬ ржХрзЗржоржи ржЖржЫрзЛ?", "ржЖржорж┐ ржорзЛржЯрж╛ржорзБржЯрж┐ ржнрж╛рж▓рзЛ ржЖржЫрж┐ред",
  "ржЖржЬ ржЖржорж┐ ржЦрзБржм ржЦрзБрж╢рж┐ред", "ржЖржорж┐ ржЕржирзЗржХ ржжрзБржГржЦрж┐ржд ржЖржЫрж┐ред", "ржЖржорж╛ржХрзЗ ржХрзНрж╖ржорж╛ ржХрж░рзЗ ржжрж╛ржУред", "рждрзЛржорж╛ржХрзЗ ржЕржирзЗржХ ржзржирзНржпржмрж╛ржжред",
  "рждрзБржорж┐ ржХрж┐ ржХржлрж┐ ржЦрж╛ржмрзЗ?", "ржирж╛, ржЖржорж┐ рж╢рзБржзрзБ ржЪрж╛ ржЦрж╛ржмрзЛред", "ржПржЦржи ржЖржорж╛рж░ ржШрзБржо ржкрж╛ржЪрзНржЫрзЗред", "ржЖржорж┐ ржШрзБржорж╛рждрзЗ ржпрж╛ржЪрзНржЫрж┐ред",
  "ржжрж░ржЬрж╛ржЯрж╛ ржмржирзНржз ржХрж░рзЗ ржжрж╛ржУред", "ржЬрж╛ржирж╛рж▓рж╛ржЯрж╛ ржПржХржЯрзБ ржЦрзБрж▓рзЛред", "рж╢рзАрждрж▓ ржмрж╛рждрж╛рж╕ ржЖрж╕ржЫрзЗред", "ржмрзГрж╖рзНржЯрж┐ ржПржЦржи ржерзЗржорзЗ ржЧрзЗржЫрзЗред",
  "ржЖржорж┐ ржХрзЛржерж╛ржпрж╝ ржпрж╛ржмрзЛ ржПржЦржи?", "рждрзБржорж┐ ржмрж╛ржЬрж╛рж░рзЗ ржЪрж▓рзЗ ржпрж╛ржУред", "ржмрж╛ржЬрж╛рж░ ржХрждржжрзВрж░рзЗ ржЖржЫрзЗ?", "ржмрж╛ржЬрж╛рж░ржЯрж╛ ржЦрзБржм ржХрж╛ржЫрзЗржЗ ржЖржЫрзЗред",
  "ржЖржорж┐ рж╣рж╛ржБржЯрждрзЗ ржпрж╛ржмрзЛ ржПржЦржиред", "ржЪрж▓ ржЖржорж░рж╛ ржПржХрж╕рж╛ржерзЗ рж╣рж╛ржБржЯрж┐ред", "ржЖржорж┐ ржирждрзБржи ржмржирзНржзрзБ ржЪрж╛ржЗред", "рждрзБржорж┐ ржЖржорж╛рж░ рж╕рзЗрж░рж╛ ржмржирзНржзрзБред",
  "рждрзБржорж┐ ржХрж┐ ржПржЦржи ржЦрзБрж╢рж┐?", "рж╣рзНржпрж╛ржБ, ржЖржорж┐ рж╕рждрзНржпрж┐ржЗ ржЦрзБрж╢рж┐ред", "ржЖржЬ рж╕рзНржХрзБрж▓ ржмржирзНржз рж░ржпрж╝рзЗржЫрзЗред", "ржЖржорж┐ ржЦрзЗрж▓рждрзЗ ржпрж╛ржЪрзНржЫрж┐ред",
  "рждрзБржорж┐ ржХрж┐ ржлрзБржЯржмрж▓ ржЦрзЗрж▓ржмрзЗ?", "ржирж╛, ржЖржорж┐ ржХрзНрж░рж┐ржХрзЗржЯ ржЦрзЗрж▓ржмрзЛред", "ржЖржЬ ржорзНржпрж╛ржЪ рж╢рзБрж░рзБ рж╣ржпрж╝рзЗржЫрзЗред", "ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ ржЖржЬ ржЬрж┐рждрзЗржЫрзЗред",
  "ржЖржорж┐ ржЧрж╛ржи рж╢рзБржиржЫрж┐ ржПржЦржиред", "рждрзБржорж┐ ржХрзА ржкржбрж╝ржЫрзЛ ржмрж▓рзЛ?", "рж╣рзНржпрж╛ржБ, ржЖржорж┐ ржмрж╛ржВрж▓рж╛ ржкржбрж╝ржЫрж┐ред", "ржЖржорж┐ ржХржмрж┐рждрж╛ рж▓рж┐ржЦржЫрж┐ред",
  "рждрзБржорж┐ ржХрзА ржХрж╛ржЬ ржХрж░ржЫрзЛ?", "ржЖржорж┐ рж░рж╛ржирзНржирж╛ ржХрж░ржЫрж┐ ржПржЦржиред", "ржЦрж╛ржУржпрж╝рж╛ рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ ржХрж┐?", "рж╣рзНржпрж╛ржБ, ржПржЦржиржЗ рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗред",
  "ржЦрзЗрждрзЗ ржПрж╕рзЛ рж╕ржмрж╛ржЗред", "ржЖржорж┐ рждрж╛ржбрж╝рж╛рждрж╛ржбрж╝рж┐ ржЖрж╕ржЫрж┐ред", "ржЖржорж╛ржХрзЗ ржПржЦржиржЗ ржбрж╛ржХрзЛред", "рждрзБржорж┐ ржХржЗ ржЧрж┐ржпрж╝рзЗржЫрж┐рж▓рзЗ ржмрж▓рзЛ?",
  "ржЖржорж┐ ржмрж╛ржЬрж╛рж░рзЗ ржЧрж┐ржпрж╝рзЗржЫрж┐рж▓рж╛ржоред", "рждрзБржорж┐ ржХрзА ржХрж┐ржирзЗржЫрзЛ ржмрж▓рзЛ?", "ржЖржорж┐ ржлрж▓ржорзВрж▓ ржХрж┐ржирзЗржЫрж┐ред", "ржПржЗ ржЖржоржЯрж╛ ржЦрзБржм ржорж┐рж╖рзНржЯрж┐ред",
  "ржЖржорж┐ рж▓рж┐ржЪрзБ ржЦрзЗрждрзЗ ржЪрж╛ржЗред", "ржжрзБржзржЯрж╛ ржПржЦржи ржЧрж░ржо ржЖржЫрзЗред", "ржЪрж╛рж▓ ржЖржирзЛ ржШрж░рзЗрж░ ржнрж┐рждрж░ред", "ржбрж╛рж▓ржЯрж╛ ржЖржорж╛ржХрзЗ ржжрж╛ржУред"
];

// Load sentences in UI
const sentenceBox = document.getElementById("sentences");
sentences.forEach((s, i) => {
  const p = document.createElement("p");
  p.textContent = (i+1) + ". " + s;
  sentenceBox.appendChild(p);
});

// ЁЯОд Recording
let mediaRecorder;
let audioChunks = [];
let fileIndexMap = {}; // counters per dialect

const startBtn = document.getElementById("startBtn");
const stopBtn = document.getElementById("stopBtn");
const status = document.getElementById("status");
const dialectSelect = document.getElementById("dialect");

startBtn.onclick = async () => {
  const dialect = dialectSelect.value;
  if (!dialect) {
    alert("ржкрзНрж░ржержорзЗ ржПржХржЯрж┐ ржбрж╛ржпрж╝рж╛рж▓рзЗржХрзНржЯ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи");
    return;
  }

  if (!(dialect in fileIndexMap)) fileIndexMap[dialect] = 0;

  const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
  mediaRecorder = new MediaRecorder(stream);
  mediaRecorder.start();
  audioChunks = [];

  mediaRecorder.ondataavailable = e => audioChunks.push(e.data);

  mediaRecorder.onstop = () => {
    const blob = new Blob(audioChunks, { type: "audio/wav" });
    const url = URL.createObjectURL(blob);

    const fileName = `${dialect}_train (${fileIndexMap[dialect]++}).wav`;

    // Trigger download
    const a = document.createElement("a");
    a.href = url;
    a.download = fileName;
    a.click();

    status.textContent = `ржлрж╛ржЗрж▓ рж╕ржВрж░ржХрзНрж╖рж┐ржд рж╣ржпрж╝рзЗржЫрзЗ: ${fileName}`;
  };

  status.textContent = "рж░рзЗржХрж░рзНржб ржЪрж▓ржЫрзЗ... ржПржХржЯрж┐ ржорж╛рждрзНрж░ ржмрж╛ржХрзНржп ржкржбрж╝рзБржиред";
  startBtn.disabled = true;
  stopBtn.disabled = false;
};

stopBtn.onclick = () => {
  mediaRecorder.stop();
  status.textContent = "рж░рзЗржХрж░рзНржб рж╢рзЗрж╖ рж╣ржпрж╝рзЗржЫрзЗред ржкрж░рзЗрж░ ржмрж╛ржХрзНржпрзЗрж░ ржЬржирзНржп ржЖржмрж╛рж░ 'рж░рзЗржХрж░рзНржб рж╢рзБрж░рзБ' ржЪрж╛ржкрзБржиред";
  startBtn.disabled = false;
  stopBtn.disabled = true;
};
